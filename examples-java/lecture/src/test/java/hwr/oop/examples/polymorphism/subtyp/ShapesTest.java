package hwr.oop.examples.polymorphism.subtyp;

import static org.assertj.core.api.Assertions.assertThat;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Nested;
import org.junit.jupiter.api.Test;

@DisplayName("Polymorphism: Subtyping: Shapes")
class ShapesTest {

  @Nested
  @DisplayName("Squares")
  class SquareTest {

    @Test
    void square_IsPolymorphicType() {
      Shape square = new Square(42);
      assertThat(square)
          .isInstanceOf(Object.class)
          .isInstanceOf(Shape.class)
          .isInstanceOf(Quadrangle.class)
          .isInstanceOf(Rectangle.class)
          .isInstanceOf(Square.class);
    }

    @Test
    void squareIsRectangle_ButRectangleIsNoSquare() {
      Shape square = new Square(42);
      Shape rectangle = new Rectangle(13, 37);
      assertThat(square).isInstanceOf(Rectangle.class);
      assertThat(rectangle).isNotInstanceOf(Square.class);
    }

    @Test
    void square_GetPerimeterLength_IsFourTimesProvidedSize() {
      Shape square = new Square(42);
      double perimeterLength = square.getPerimeterLength();
      assertThat(perimeterLength).isEqualTo(4 * 42);
    }

    @Test
    void square_GetAreaSize_IsSideLengthSquared() {
      Shape square = new Square(42);
      double areaSize = square.getAreaSize();
      assertThat(areaSize).isEqualTo(42 * 42);
    }

    @Test
    void square_GetNumberOfSides_ReturnsFour() {
      Shape square = new Square(42);
      int numberOfSides = square.getNumberOfSides();
      assertThat(numberOfSides).isEqualTo(4);
    }
  }

  @Nested
  @DisplayName("Rectangles")
  class RectangleTest {

    @Test
    void rectangle_IsPolymorphicType() {
      Rectangle rectangle = new Rectangle(42, 1337);
      assertThat(rectangle)
          .isInstanceOf(Object.class)
          .isInstanceOf(Shape.class)
          .isInstanceOf(Quadrangle.class)
          .isInstanceOf(Rectangle.class);
    }

    @Test
    void rectangle_GetPerimeterLength_IsFourTimesProvidedSize() {
      Shape rectangle = new Rectangle(42, 1337);
      double perimeterLength = rectangle.getPerimeterLength();
      assertThat(perimeterLength).isEqualTo(42 + 42 + 1337 + 1337);
    }

    @Test
    void rectangle_GetAreaSize_IsSideLengthSquared() {
      Shape rectangle = new Rectangle(1337, 42);
      double areaSize = rectangle.getAreaSize();
      assertThat(areaSize).isEqualTo(42 * 1337);
    }

    @Test
    void rectangle_GetNumberOfSides_ReturnsFour() {
      Shape rectangle = new Rectangle(42, 1337);
      int numberOfSides = rectangle.getNumberOfSides();
      assertThat(numberOfSides).isEqualTo(4);
    }

  }

}
